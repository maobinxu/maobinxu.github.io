



**异方差性**：对于不同的样本点，随机干扰项的方差不是常数，互不相同（heteroscedasticity）

类型：
> ① 单调递增型：$\sigma_i^2$随X的增大而增大  
> ② 单调递减型：$\sigma_i^2$随X的增大而减小  
> ③ 复杂型：$\sigma_i^2$与$X$的变化呈复杂形式

## 一、后果
1、参数估计量非有效
> OLS估计量仍然具有线性性、无偏性、一致性、渐近正态

2、变量的显著性检验失去意义
> t、F统计量利用了同方差条件


3、模型的预测失效

## 二、检验
原理：首先采用OLS估计，得到残差估计值，用它的平方近似随机误差项的方差

### （一）图示检验法

> $X$与$e_i^2$的散点图

### （二）帕克检验（Park test）

> $\tilde{e} _i^2 =f(X_{ji})+\varepsilon_{i} =\sigma^2X_{ji}^\alpha e^{\varepsilon_i}$  
> 若$\alpha$在统计上是显著的，表明存在异方差性

### （三）戈里瑟检验（Glejser test）

> $$
> \left|{\widetilde{e}}_i^2\right| =f\left(X_{ji}\right)+\varepsilon_i
> $$

### （四）布罗施-帕甘检验（Breusch-Pagan test）

> $\varepsilon_i^2\approx{\hat{\varepsilon}}_i^2=\delta_0+\delta_1X_{i1}+\delta_2X_{i2}+\cdots+\delta_kX_{ik}+e$ ，可决系数为$R_{{\hat{\varepsilon}}^2}^2$  
> $$
> H_0：δ_0=δ_1=δ_2=\cdots=δ_k=0\\ F =  \frac{ R_{{\hat{\varepsilon}}^2}^2/k}{    {(1-R}_{{\hat{\varepsilon}}^2}^2)/(n-k-1)}\\ 拉格朗日乘数检验：LM=n⋅R_{{\hat{\varepsilon}}^2}^2\sim \chi(k) 
> $$
> 若$F$或$LM$＞临界值则拒绝$H_0$，表明存在异方差性

### （五）怀特检验（White test）

> 二元为例：
> $$
> \varepsilon_i^2\approx{\hat{\varepsilon}}_i^2=\delta_0+\delta_1X_{i1}+\delta_2X_{i2}+\delta_3X_{i1}^2+\delta_4X_{i2}^2+\delta_5X_{i1}X_{i2}+e_i \\ H_0：δ_1=δ_2=\cdots=δ_5=0\\ F=\frac{R_{{\hat{\varepsilon}}^2}^2/k}{{(1-R}_{{\hat{\varepsilon}}^2}^2)/(n-k-1)}\\ LM=n⋅R_{{\hat{\varepsilon}}^2}^2\sim \chi(k)
> $$
> 若$F$或$LM$＞临界值则拒绝$H_0$，表明存在异方差性

### （六）斯皮尔曼等级相关检验法（Spearman Rank Relation test）

### （七）戈德弗尔德-匡特检验法（Goldfeld Quandt test）

## 三、解决方法

### （一）广义最小二乘法（Generalized Least Squares，GLS）

### （二）加权最小二乘法（Weighted Least Squares, WLS）

> GLS的特例，在采用OLS方法时：对较小的残差平方 $\hat{\varepsilon}_i^2$赋予较大的权数；对较大的残差平方$\hat{\varepsilon}_i^2$赋予较小的权数
> $$
> \sum{w_i \hat{\varepsilon}_i^2}=\sum{w_i\left[Y_i-(\hat{\beta}_0+\hat{\beta}_1 X_1 + \hat{\beta}_2 X_2 +\cdots+\hat{\beta}_k X_k)\right]^2}，w_i为权数
> $$

### （三）异方差稳健标准误法（Heteroscedasticity-Consistent Variances and Standard Errors）

> 仍然采用OLS，但对OLS估计量的标准差进行修正  
> 一元回归：大样本下，$\sum{ \frac{x_i^2 \hat{\varepsilon}_i^2}{(\sum{x_i^2})^2}}$是$Var(\hat{\beta}_1) = \sum{ \frac{x_i^2 \sigma_i^2}{(\sum{x_i^2})^2}}$的一致估计


