





**时间序列的平稳性**：假定某个时间序列是由某一随机过程（stochastic process）生成的，即假定时间序列${X_t}(t=1,2,…)$的每一个数值都是从一个概率分布中随机得到，如果满足下列条件：

> ① 均值$E(X_t)=\mu$是与时间$t$无关的常数  
> ② 方差$Var\left(X_t\right)=\sigma^2$是与时间$t$无关的常数  
> ③ 协方差$Cov\left(X_t,X_{t+k}\right)=\gamma_k$是只与时期间隔$k$有关，与时间$t$无关的常数

## 一、平稳时间序列

### （一）分类

1、严平稳
> $\forall正整数m,∀t_1,t_2,⋯,t_m∈T，\forall正整数τ，有：F_{t_1,t_2,⋯,t_m}(x_1,x_2,⋯,x_m)=F_{t_{1+τ},t_{2+τ},⋯,t_{m+τ}}(x_1,x_2,⋯,x_m)$

2、宽平稳
> ① $EX_t^2<\infty,\forall t\in T$  
> ② $EXt=μ,μ为常数，∀t∈T$  
> ③ $γ(t,s)=γ(k,k+s-t)，∀t,s,k且k+s-t∈T$

### （二）好处

1、可替代随机抽样假定

2、有效减少虚假回归/伪回归（spurious regression）

### （三）例子

1、白噪声序列（white noise）

定义：$X_t=\mu_t，μt~N(0,σ2)$，又称纯随机序列
> ① 纯随机性：$\gamma(k)=0，∀k≠0$，各序列值之间没有任何相关关系，即为“没有记忆”的序列，如果时间序列是白噪声，分析则无意义  
> ② 方差齐性：$DX_t=\gamma(0)=\sigma^2$。根据马尔可夫定理，只有方差齐性假定成立时，用最小二乘法得到的未知参数估计值才是准确的、有效的

检验：
> $H_0：ρ_1=ρ_2=⋯=ρ_m=0,∀m≥1$ 。延迟期数小于或等于m期的序列值之间相互独立。为白噪声序列  
> $H_1：至少存在某个ρ_k≠0,∀m≥1，k≤m$。延迟期数小于或等于m期的序列值之间有相关性  
> Q统计量：$Q=n\sum_{k=1}^{m}{\hat{\rho}}_k^2~\chi^2\left(m\right)$  
> LB(Ljung-Box)统计量：$LB=n(n+2)\sum_{k=1}^{m}{(\frac{{\hat{\rho}}_k^2}{n-k})}~\chi^2(m)$

2、d阶单整序列（integrated of d）

定义：原时间序列经过d次差分变平稳
> 一阶自回归$AR(1)$过程：$X_t=\phi X_{t-1}+\mu_t，μ_t\sim N(0,σ_2)$  
> $\left|\phi\right|>1$：随机过程生成的时间序列发散  
> $\Phi=1$：随机游走（random walk）过程，非平稳  
> $∆X_t=X_t-X_{t-1}=μ_t$

## 二、检验
单位根检验：通过检验特征根是在单位圆内还是单位圆上（外），来检验序列的平稳性（unit root test）

### （一）图示法

> 1、时序图检验：根据平稳时间序列均值、方差为常数的性质，平稳序列的时序图应该显示出该序列始终在一个常数值附近随机波动，而且波动的范围有界、无明显趋势及周期特征  
> 2、自相关图检验：平稳序列通常具有短期相关性。该性质用自相关系数来描述就是随着延迟期数的增加，平稳序列的自相关系数会很快地衰减向零

### （二）DF检验（Dicky-Fuller test）

一阶序列相关

> $X_t=\alpha+\rho X_{t-1}+\mu_t$或$∆X_t=α+δX_{t-1}+μ_{t}$  
> $H_0：δ=0，即ρ=1；H_1：δ<0，即ρ<1 $  
> $\rho=\left|\varphi_1\right|-1， \tau=\frac{\hat{\rho}}{S(\hat{\rho})}$  
> $H_0$：$φ_1≥1$，非平稳；  
> $\left|\varphi_1\right|<1$时，$t(φ_1)=\frac{\hat{φ}_1-φ_1}{S(\hat{φ}_1)}$渐进$N(0,1)$  
> $\left|\varphi_1\right|=1$时，$τ=\frac{|\hat{φ}_1|-1}{S(\hat{φ}_1)}$极限$\frac{\int_{0}^{1}W(r)dW(r)}{\int_{0}^{1}[W(r)]^2dr}$  
> 若拒绝$H_0$（$t<\tau$临界值，$t$统计量有偏误）则为平稳序列  
> $x_t=\phi_{1}x_{t-1}+\varepsilon_t$  
> $x_t=\mu+\varphi_{1}x_{t-1}+\varepsilon_t$  
> $x_t=\mu+\beta t+\varphi_{1}x_{t-1}+\varepsilon_t$

### （三）ADF检验（Augmented Dickey-Fuller test）

多阶序列相关，用于方差齐性的情况。

> 若$AR(p)$序列有单位根存在，则自回归系数之和恰好等于1  
> $$
> \lambda^p-\varphi_1\lambda^{p-1}-\cdots-\varphi_p=0 \Rightarrow^{\lambda=1} 1-\varphi_1-\cdots-\varphi_p=0 \Rightarrow\varphi_1+\varphi_2+\cdots+\varphi_p=1
> $$
> 
> $x_t=\varphi_{1}x_{t-1}+\cdots+\varphi_{p}x_{t-p}+\varepsilon_t$  
> $x_t=\mu+\varphi_{1}x_{t-1}+\cdots+\varphi_{p}x_{t-p}+\varepsilon_t$  
> $x_t=\mu+\beta t+\varphi_{1}x_{t-1}+\cdots+\varphi_{p}x_{t-p}+\varepsilon_t$  
> 模型1：$∆X_t=δX_{t-1}+\sum_{i=1}^{m}β_i∆X_{t-i}+ε_t$  
> 模型2：$∆X_t=α+δX_{t-1}+\sum_{i=1}^{m}β_i∆X_{t-i}+ε_{t}$  
> 模型3：$∆X_t=α+β_T+δX_{t-1}+\sum_{i=1}^{m}β_i∆X_{t-i}+ε_{t}$  
> $T$：趋势项，时间变量，代表时间序列随时间变化的趋势  
> $\alpha$：漂移项   
> $m$：滞后阶数，一般用$LM$检验确定  
> $H_0：δ=0；H_1：δ<0$；$\tau=\frac{\hat{\rho}}{S(\hat{\rho})}$  
> 自下而上检验，拒绝$H_0$（$t<\tau$临界值）则为平稳序列，否则继续检验

### （四）PP检验

异方差的平稳性检验

$$
Z\left(\tau\right) =\tau(\hat{\sigma}^2/\hat{\sigma}_{Sl}^2 ) -\frac{1}{2}  (\hat{\sigma}_{Sl}^2-\hat{\sigma}^2) T \sqrt{\hat{\sigma}_{Sl}^2 \sum_{t=2}^{T}{(x_{t-1}-x_{T-1})^2}} 
$$
> ① ${\hat{\sigma}}^2=T^{-1}\sum_{t=1}^{T}{\hat{\varepsilon}}_t^2$  
> ② ${\hat{\sigma}}_{Sl}^2=T^{-1}\sum_{t=1}^{T}{\hat{\varepsilon}}_t^2+2T^{-1}\sum_{j=1}^{l}{w_j(l)\sum_{t=j+1}^{T}{{\hat{\varepsilon}}_t{\hat{\varepsilon}}_{t-j}}}$  
> ③ $\bar{x}_{T-1}=\frac{1}{T-1}\sum_{t=1}^{T-1}{x_t}$







